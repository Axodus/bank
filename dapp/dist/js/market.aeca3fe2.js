(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["market"],{"49cc":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{staticClass:"BorrowForm mx-5",attrs:{"lazy-validation":!0}},[r("v-card-text",{staticClass:"pb-0"},[r("v-container",{attrs:{fluid:""}},[r("v-row",[r("h2",[t._v("Borrow from market "+t._s(t.marketAddress)+" of token "+t._s(t.tokenSymbol))])]),r("v-row",[r("v-col",{staticClass:"pb-0",attrs:{cols:"10"}},[r("v-text-field",{attrs:{label:"Borrow amount",rules:[t.rules.required,t.rules.liquidity],type:"number",required:""},model:{value:t.amount,callback:function(e){t.amount=t._n(e)},expression:"amount"}})],1),r("v-col",{attrs:{cols:"2"}},[r("v-switch",{attrs:{color:"success",label:"MÃ¡ximo"},model:{value:t.maxAmount,callback:function(e){t.maxAmount=e},expression:"maxAmount"}})],1)],1)],1)],1),r("v-card-actions",{staticClass:"pl-6 pb-4 pt-0"},[r("v-btn",{attrs:{disabled:!t.validForm,color:"success"},on:{click:t.borrow}},[t._v(" Borrow ")])],1)],1)},o=[],s=(r("a9e3"),r("d3b7"),r("3ca3"),r("ddb0"),r("3835")),n=r("5530"),i=r("2f62"),l=r("8cc6"),c=r("0514"),u=r("4220"),d={name:"BorrowForm",props:{marketAddress:{type:String,required:!0},maxAmountAllowed:{type:Number,required:!0}},data:function(){var t=this;return{controller:null,market:null,marketPrice:null,amount:null,tokenName:null,tokenSymbol:null,liquidity:null,validForm:!1,maxAmount:!1,rules:{required:function(){return!!t.amount||"Required."},liquidity:function(){return t.liquidity>=2*t.marketPrice*t.amount||"not enough liquidity"}}}},computed:Object(n["a"])({},Object(i["d"])({account:function(t){return t.Session.account}})),methods:{borrow:function(){var t=this;this.market.borrow(this.account,this.amount).then((function(){t.$emit("formSucceed")}))},getLiquidity:function(){var t=this;this.controller.getLiquidity(this.account).then((function(e){t.liquidity=Number(e)}))}},watch:{amount:function(){this.validForm="string"!==typeof this.rules.liquidity()&&"string"!==typeof this.rules.required()},maxAmount:function(){this.maxAmount?this.amount=this.maxAmountAllowed:this.amount=null}},created:function(){var t=this;this.market=new l["a"](this.marketAddress),this.controller=new u["a"],this.market.eventualTokenAddress.then((function(t){var e=new c["a"](t);return[e.eventualName,e.eventualSymbol]})).then((function(t){return Promise.all(t)})).then((function(e){var r=Object(s["a"])(e,2),a=r[0],o=r[1];t.tokenName=a,t.tokenSymbol=o})),this.getLiquidity(),this.controller.getPrice(this.marketAddress).then((function(e){t.marketPrice=Number(e)}))}},m=d,h=r("2877"),v=r("6544"),f=r.n(v),p=r("8336"),w=r("b0af"),k=r("99d9"),b=r("62ad"),y=r("a523"),B=r("0fd9"),_=r("b73d"),g=r("8654"),x=Object(h["a"])(m,a,o,!1,null,null,null);e["a"]=x.exports;f()(x,{VBtn:p["a"],VCard:w["a"],VCardActions:k["a"],VCardText:k["b"],VCol:b["a"],VContainer:y["a"],VRow:B["a"],VSwitch:_["a"],VTextField:g["a"]})},"4bd4":function(t,e,r){"use strict";r("4de4"),r("7db0"),r("4160"),r("caad"),r("07ac"),r("2532"),r("159b");var a=r("5530"),o=r("58df"),s=r("7e2b"),n=r("3206");e["a"]=Object(o["a"])(s["a"],Object(n["b"])("form")).extend({name:"v-form",inheritAttrs:!1,props:{lazyValidation:Boolean,value:Boolean},data:function(){return{inputs:[],watchers:[],errorBag:{}}},watch:{errorBag:{handler:function(t){var e=Object.values(t).includes(!0);this.$emit("input",!e)},deep:!0,immediate:!0}},methods:{watchInput:function(t){var e=this,r=function(t){return t.$watch("hasError",(function(r){e.$set(e.errorBag,t._uid,r)}),{immediate:!0})},a={_uid:t._uid,valid:function(){},shouldValidate:function(){}};return this.lazyValidation?a.shouldValidate=t.$watch("shouldValidate",(function(o){o&&(e.errorBag.hasOwnProperty(t._uid)||(a.valid=r(t)))})):a.valid=r(t),a},validate:function(){return 0===this.inputs.filter((function(t){return!t.validate(!0)})).length},reset:function(){this.inputs.forEach((function(t){return t.reset()})),this.resetErrorBag()},resetErrorBag:function(){var t=this;this.lazyValidation&&setTimeout((function(){t.errorBag={}}),0)},resetValidation:function(){this.inputs.forEach((function(t){return t.resetValidation()})),this.resetErrorBag()},register:function(t){this.inputs.push(t),this.watchers.push(this.watchInput(t))},unregister:function(t){var e=this.inputs.find((function(e){return e._uid===t._uid}));if(e){var r=this.watchers.find((function(t){return t._uid===e._uid}));r&&(r.valid(),r.shouldValidate()),this.watchers=this.watchers.filter((function(t){return t._uid!==e._uid})),this.inputs=this.inputs.filter((function(t){return t._uid!==e._uid})),this.$delete(this.errorBag,e._uid)}}},render:function(t){var e=this;return t("form",{staticClass:"v-form",attrs:Object(a["a"])({novalidate:!0},this.attrs$),on:{submit:function(t){return e.$emit("submit",t)}}},this.$slots.default)}})},c158:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("borrow-list",{attrs:{marketAddresses:t.marketAddresses}})],1)},o=[],s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-container",{staticClass:"d-flex justify-center",attrs:{fluid:""}},[r("v-card",{attrs:{width:"80%",elevation:"0"}},[r("v-list",[r("v-list-item",[r("v-row",[r("v-col",{attrs:{cols:"4"}},[r("v-list-item-subtitle",{staticClass:"text-center"},[t._v("Assets")])],1),r("v-col",{attrs:{cols:"4"}},[r("v-list-item-subtitle",{staticClass:"text-center"},[t._v("Available for you")])],1),r("v-col",{attrs:{cols:"4"}},[r("v-list-item-subtitle",{staticClass:"text-center"},[t._v("APR%")])],1)],1)],1),t._l(t.marketAddresses,(function(t,e){return r("borrow-item",{key:"market-item-"+e,attrs:{marketAddress:t}})}))],2)],1)],1)],1)},n=[],i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"LiquidatedItem"},[r("v-card",{staticClass:"mt-5",attrs:{outlined:""}},[r("v-list-item",{on:{click:function(e){return t.enableForm()}}},[r("v-row",[r("v-col",{staticClass:"d-flex justify-end",attrs:{cols:"2"}},[r("v-list-item-avatar",[r("v-img",{attrs:{src:"https://www.coinopsy.com/media/img/quality_logo/bitcoin-btc.png"}})],1)],1),r("v-col",{attrs:{cols:"2"}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"text-left"},[t._v(" "+t._s(t.tokenSymbol)+" ")])],1)],1),r("v-col",{attrs:{cols:"4"}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"text-center"},[t._v(" "+t._s(t.maxBorrowAllowed)+" ")])],1)],1),r("v-col",{attrs:{cols:"4"}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"text-center"},[t._v(" 5% ")])],1)],1)],1)],1)],1),t.flag?[r("borrow-form",{attrs:{marketAddress:t.marketAddress,maxAmountAllowed:t.maxBorrowAllowed},on:{formSucceed:t.reset}})]:t._e()],2)},l=[],c=(r("a9e3"),r("d3b7"),r("3ca3"),r("ddb0"),r("3835")),u=r("5530"),d=r("49cc"),m=r("2f62"),h=r("4220"),v=r("8cc6"),f=r("0514"),p={name:"BorrowItem",props:{marketAddress:{type:String,required:!0}},data:function(){return{flag:!1,market:null,token:null,tokenName:null,tokenSymbol:null,liquidity:null,marketPrice:null,marketCash:null,maxBorrowAllowed:null}},computed:Object(u["a"])({},Object(m["d"])({account:function(t){return t.Session.account}})),methods:{reset:function(){this.flag=!1,this.getMaxBorrowAllowed()},enableForm:function(){this.flag=!this.flag},getMaxBorrowAllowed:function(){var t=this;this.market.eventualCash.then((function(e){return t.marketCash=e,t.controller.getLiquidity(t.account)})).then((function(e){return t.liquidity=Number(e),t.controller.getPrice(t.marketAddress)})).then((function(e){t.marketPrice=Number(e),t.maxBorrowAllowed=Math.floor(t.liquidity/(2*t.marketPrice)),t.maxBorrowAllowed=t.maxBorrowAllowed>=t.marketCash?t.marketCash:t.maxBorrowAllowed}))}},components:{BorrowForm:d["a"]},created:function(){var t=this;this.controller=new h["a"],this.market=new v["a"](this.marketAddress),this.market.eventualTokenAddress.then((function(e){return t.token=new f["a"](e),[t.token.eventualName,t.token.eventualSymbol]})).then((function(t){return Promise.all(t)})).then((function(e){var r=Object(c["a"])(e,2),a=r[0],o=r[1];t.tokenName=a,t.tokenSymbol=o})),this.getMaxBorrowAllowed()}},w=p,k=r("2877"),b=r("6544"),y=r.n(b),B=r("b0af"),_=r("62ad"),g=r("adda"),x=r("da13"),C=r("8270"),A=r("5d23"),S=r("0fd9"),V=Object(k["a"])(w,i,l,!1,null,null,null),O=V.exports;y()(V,{VCard:B["a"],VCol:_["a"],VImg:g["a"],VListItem:x["a"],VListItemAvatar:C["a"],VListItemContent:A["a"],VListItemTitle:A["c"],VRow:S["a"]});var F={name:"BorrowList",props:{marketAddresses:{type:Array,required:!0}},components:{BorrowItem:O}},P=F,q=r("a523"),M=r("8860"),T=Object(k["a"])(P,s,n,!1,null,"7acf683c",null),j=T.exports;y()(T,{VCard:B["a"],VCol:_["a"],VContainer:q["a"],VList:M["a"],VListItem:x["a"],VListItemSubtitle:A["b"],VRow:S["a"]});var $={name:"Borrow",data:function(){return{controller:null,marketAddresses:[]}},components:{BorrowList:j},methods:{loadMarkets:function(){var t=this;this.controller.eventualMarketAddresses.then((function(e){t.marketAddresses=e}))}},created:function(){this.controller=new h["a"],this.loadMarkets()}},R=$,N=Object(k["a"])(R,a,o,!1,null,null,null);e["default"]=N.exports},e88b:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h1",[t._v("Market "+t._s(t.tokenSymbol))]),t.isOwner?[r("price",{attrs:{marketAddress:t.id,price:Number(t.price)}})]:[r("v-card",{staticClass:"ma-5",attrs:{"max-width":"80%",dark:""}},[r("v-card-text",[r("v-row",{attrs:{align:"center"}},[r("v-col",{staticClass:"display-0"},[t._v("Asset")])],1),r("v-row",{attrs:{align:"center"}},[r("v-col",{staticClass:"display-2",attrs:{cols:"6"}},[t._v(t._s(t.tokenSymbol))]),r("v-col",{attrs:{cols:"6"}},[r("v-img",{attrs:{src:t.btc,width:"70"}})],1)],1),r("v-row",{attrs:{align:"center"}},[r("v-col",{staticClass:"display-0",attrs:{cols:"3"}},[t._v("Total supply")]),r("v-col",{staticClass:"display-0",attrs:{cols:"3"}},[t._v("Total borrows")]),r("v-col",{staticClass:"display-0",attrs:{cols:"3"}},[t._v("Price")]),r("v-col",{staticClass:"display-0",attrs:{cols:"3"}},[t._v("Base borrow rate")])],1),r("v-row",{attrs:{align:"center"}},[r("v-col",{staticClass:"display-1",attrs:{cols:"3"}},[t._v(t._s(t.totalSupply))]),r("v-col",{staticClass:"display-1",attrs:{cols:"3"}},[t._v(t._s(t.totalBorrows))]),r("v-col",{staticClass:"display-1",attrs:{cols:"3"}},[t._v(t._s(t.price))]),r("v-col",{staticClass:"display-1",attrs:{cols:"3"}},[t._v(t._s(t.baseBorrowRate)+"%")])],1)],1)],1),r("v-card",{staticClass:"ma-5",attrs:{"max-width":"80%"}},[r("v-card-text",[r("p",{staticClass:"display-1 text--primary"},[t._v(" Balance ")]),r("v-row",{attrs:{align:"center"}},[r("v-col",{staticClass:"display-0 text-center",attrs:{cols:"4"}},[t._v(t._s(t.tokenSymbol)+" balance")]),r("v-col",{staticClass:"display-0 text-center",attrs:{cols:"4"}},[t._v("Supplied")]),r("v-col",{staticClass:"display-0 text-center",attrs:{cols:"4"}},[t._v("Borrowed")])],1),r("v-row",{attrs:{align:"center"}},[r("v-col",{staticClass:"display-1 text-center",attrs:{cols:"4"}},[t._v(t._s(t.tokenBalanceOf))]),r("v-col",{staticClass:"display-1 text-center",attrs:{cols:"4"}},[t._v(t._s(t.supplyOf))]),r("v-col",{staticClass:"display-1 text-center",attrs:{cols:"4"}},[t._v(t._s(t.borrowBy))])],1)],1),r("v-card-actions",{staticClass:"d-flex justify-space-around"},[r("v-btn",{staticClass:"my-2",attrs:{"x-large":"",raise:"",color:"green",dark:""},on:{click:t.showSupplyForm}},[t._v(" Supply ")]),r("v-btn",{staticClass:"my-2",attrs:{"x-large":"",depressed:"",color:"blue",dark:""},on:{click:t.showBorrowForm}},[t._v(" Borrow ")]),r("v-btn",{staticClass:"my-2",attrs:{"x-large":"",depressed:"",color:"teal",dark:""},on:{click:t.showRedeemForm}},[t._v(" Redeem ")]),r("v-btn",{staticClass:"my-2",attrs:{"x-large":"",depressed:"",color:"indigo lighten-1",dark:""},on:{click:t.showPayBorrowForm}},[t._v(" Pay debt ")])],1)],1),r(t.actionForm,{tag:"component",attrs:{marketAddress:t.id,id:"scroll-target"},on:{formSucceed:t.reset}})]],2)},o=[],s=(r("d3b7"),r("3ca3"),r("ddb0"),r("3835")),n=r("5530"),i=r("2f62"),l=r("4220"),c=r("8cc6"),u=r("0514"),d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:""}},[r("v-row",{staticClass:"d-flex flex-column"},[r("h2",[t._v("Market price")]),r("a",[t._v(t._s(t.marketAddress))])]),r("v-form",{ref:"form",attrs:{"lazy-validation":!0}},[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{value:t.price,label:"Market Price",type:"number"},on:{input:function(e){t.marketPrice=e}}})],1)],1),r("v-row",[r("v-btn",{staticClass:"success",on:{click:t.setPrice}},[t._v(" Set Price ")])],1)],1)],1)},m=[],h=(r("a9e3"),{name:"Price",data:function(){return{marketPrice:null}},props:{marketAddress:{type:String,required:!0},price:{type:Number,required:!0}},methods:{setPrice:function(){var t=this;this.controller.setPrice(this.account,this.marketAddress,this.marketPrice).then((function(){t.$router.push({name:"Settings"})}))}},computed:Object(n["a"])({},Object(i["d"])({account:function(t){return t.Session.account}})),created:function(){this.controller=new l["a"]}}),v=h,f=r("2877"),p=r("6544"),w=r.n(p),k=r("8336"),b=r("62ad"),y=r("a523"),B=r("4bd4"),_=r("0fd9"),g=r("8654"),x=Object(f["a"])(v,d,m,!1,null,null,null),C=x.exports;w()(x,{VBtn:k["a"],VCol:b["a"],VContainer:y["a"],VForm:B["a"],VRow:_["a"],VTextField:g["a"]});var A=r("c0fc"),S=r("49cc"),V=r("a006"),O=r("bfdc"),F={name:"Market",props:{id:{type:String,required:!0}},data:function(){return{controller:null,price:null,market:null,token:null,totalSupply:null,totalBorrows:null,tokenName:null,tokenSymbol:null,btc:"https://www.coinopsy.com/media/img/quality_logo/bitcoin-btc.png",tokenBalanceOf:null,supplyOf:null,borrowBy:null,baseBorrowRate:null,actionForm:null}},computed:Object(n["a"])({},Object(i["d"])({account:function(t){return t.Session.account},isOwner:function(t){return t.Session.isOwner}}),{pageHeight:function(){return document.body.scrollHeight}}),methods:{reset:function(){this.actionForm=null,this.loadMarketTotalSupply(),this.loadMarketTotalBorrows(),this.loadMarketSupplyOf(),this.loadMarketBorrowBy(),this.loadTokenBalanceOf()},showSupplyForm:function(){this.actionForm="SupplyForm",this.$vuetify.goTo(this.pageHeight)},showBorrowForm:function(){this.actionForm="BorrowForm",this.$vuetify.goTo(this.pageHeight)},showRedeemForm:function(){this.actionForm="RedeemForm",this.$vuetify.goTo(this.pageHeight)},showPayBorrowForm:function(){this.actionForm="PayBorrowForm",this.$vuetify.goTo(this.pageHeight)},loadTokenBalanceOf:function(){var t=this;this.token.balanceOf(this.account).then((function(e){t.tokenBalanceOf=e}))},loadMarketTotalSupply:function(){var t=this;this.market.eventualTotalSupply.then((function(e){t.totalSupply=e}))},loadMarketTotalBorrows:function(){var t=this;this.market.eventualTotalBorrows.then((function(e){t.totalBorrows=e}))},loadMarketSupplyOf:function(){var t=this;this.market.getUpdatedSupplyOf(this.account).then((function(e){t.supplyOf=e}))},loadMarketBorrowBy:function(){var t=this;this.market.getUpdatedBorrowBy(this.account).then((function(e){t.borrowBy=e}))},loadMarketBaseBorrowRate:function(){var t=this;this.market.eventualBaseBorrowRate.then((function(e){t.baseBorrowRate=e}))}},components:{Price:C,SupplyForm:A["a"],BorrowForm:S["a"],RedeemForm:V["a"],PayBorrowForm:O["a"]},created:function(){var t=this;this.controller=new l["a"],this.market=new c["a"](this.id),this.market.eventualTokenAddress.then((function(e){return t.token=new u["a"](e),[t.token.eventualName,t.token.eventualSymbol]})).then((function(t){return Promise.all(t)})).then((function(e){var r=Object(s["a"])(e,2),a=r[0],o=r[1];t.tokenName=a,t.tokenSymbol=o,t.loadTokenBalanceOf()})),this.controller.getPrice(this.id).then((function(e){t.price=e})),this.loadMarketTotalSupply(),this.loadMarketTotalBorrows(),this.loadMarketSupplyOf(),this.loadMarketBorrowBy(),this.loadMarketBaseBorrowRate()}},P=F,q=r("b0af"),M=r("99d9"),T=r("adda"),j=Object(f["a"])(P,a,o,!1,null,null,null);e["default"]=j.exports;w()(j,{VBtn:k["a"],VCard:q["a"],VCardActions:M["a"],VCardText:M["b"],VCol:b["a"],VImg:T["a"],VRow:_["a"]})}}]);
//# sourceMappingURL=market.aeca3fe2.js.map